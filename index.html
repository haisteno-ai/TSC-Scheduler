<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TSC Room Tracker ‚Äî JSU</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=DM+Sans:wght@400;500;600&family=SF+Pro+Display:wght@400;600;700&family=Courier+Prime:wght@400;700&family=Chicago&display=swap" rel="stylesheet">
  <style>
    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       THEMES
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

    /* STAY COCKY ‚Äî JSU dark red (default) */
    :root, [data-theme="cocky"] {
      --bg: #080000;
      --surface: #100000;
      --surface2: #170000;
      --border: #2e0000;
      --border-bright: #8b0000;
      --accent: #cc0000;
      --accent-glow: rgba(204,0,0,0.25);
      --text: #f0f0f0;
      --text-muted: #888;
      --text-dim: #555;
      --green: #22c55e;
      --red-alert: #ef4444;
      --header-bg: linear-gradient(135deg, #7a0000 0%, #2a0000 100%);
      --header-shadow: rgba(139,0,0,0.4);
      --clock-glow: rgba(204,0,0,0.4);
      --font-display: 'Rajdhani', sans-serif;
      --font-body: 'DM Sans', sans-serif;
      --radius: 14px;
      --jsu-text: #7a0000;
      --jsu-bg: #fff;
    }

    /* JOBS ‚Äî Classic iOS (light, rounded, blue accents) */
    [data-theme="jobs"] {
      --bg: #f2f2f7;
      --surface: #ffffff;
      --surface2: #f8f8fc;
      --border: #d1d1d6;
      --border-bright: #007aff;
      --accent: #007aff;
      --accent-glow: rgba(0,122,255,0.2);
      --text: #1c1c1e;
      --text-muted: #6c6c70;
      --text-dim: #aeaeb2;
      --green: #34c759;
      --red-alert: #ff3b30;
      --header-bg: linear-gradient(180deg, #f9f9f9 0%, #f2f2f7 100%);
      --header-shadow: rgba(0,0,0,0.12);
      --clock-glow: rgba(0,122,255,0.2);
      --font-display: -apple-system, 'SF Pro Display', 'Helvetica Neue', sans-serif;
      --font-body: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif;
      --radius: 18px;
      --jsu-text: #fff;
      --jsu-bg: #007aff;
    }

    /* WOZ ‚Äî Classic Mac (warm grey, Chicago-ish, very 1984) */
    [data-theme="woz"] {
      --bg: #c8c8c8;
      --surface: #e8e8e8;
      --surface2: #d8d8d8;
      --border: #888;
      --border-bright: #333;
      --accent: #333;
      --accent-glow: rgba(0,0,0,0.2);
      --text: #1a1a1a;
      --text-muted: #555;
      --text-dim: #999;
      --green: #006600;
      --red-alert: #cc0000;
      --header-bg: linear-gradient(180deg, #e8e8e8 0%, #c0c0c0 100%);
      --header-shadow: rgba(0,0,0,0.3);
      --clock-glow: rgba(0,0,0,0.1);
      --font-display: 'Courier Prime', 'Courier New', monospace;
      --font-body: 'Courier Prime', 'Courier New', monospace;
      --radius: 4px;
      --jsu-text: #e8e8e8;
      --jsu-bg: #333;
    }

    /* TERMINAL ‚Äî Green on black */
    [data-theme="terminal"] {
      --bg: #000000;
      --surface: #0a0a0a;
      --surface2: #0f0f0f;
      --border: #003300;
      --border-bright: #00bb00;
      --accent: #00ff00;
      --accent-glow: rgba(0,255,0,0.2);
      --text: #00ee00;
      --text-muted: #007700;
      --text-dim: #004400;
      --green: #00ff00;
      --red-alert: #ff4444;
      --header-bg: #000;
      --header-shadow: rgba(0,255,0,0.2);
      --clock-glow: rgba(0,255,0,0.5);
      --font-display: 'Courier Prime', 'Courier New', monospace;
      --font-body: 'Courier Prime', 'Courier New', monospace;
      --radius: 0px;
      --jsu-text: #000;
      --jsu-bg: #00ee00;
    }

    /* OLED ‚Äî Pure black, cool whites */
    [data-theme="oled"] {
      --bg: #000000;
      --surface: #0d0d0d;
      --surface2: #161616;
      --border: #222222;
      --border-bright: #444444;
      --accent: #ffffff;
      --accent-glow: rgba(255,255,255,0.1);
      --text: #ffffff;
      --text-muted: #888888;
      --text-dim: #444444;
      --green: #30d158;
      --red-alert: #ff453a;
      --header-bg: #000000;
      --header-shadow: rgba(255,255,255,0.05);
      --clock-glow: rgba(255,255,255,0.15);
      --font-display: -apple-system, 'SF Pro Display', 'Helvetica Neue', sans-serif;
      --font-body: -apple-system, 'SF Pro Text', 'Helvetica Neue', sans-serif;
      --radius: 16px;
      --jsu-text: #000;
      --jsu-bg: #fff;
    }

    /* ‚îÄ‚îÄ THEME SWITCHER in settings ‚îÄ‚îÄ */
    .theme-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); gap: 8px; }
    .theme-swatch {
      border-radius: 12px; padding: 10px 8px; cursor: pointer;
      border: 2px solid transparent; transition: all 0.15s;
      display: flex; flex-direction: column; align-items: center; gap: 5px;
      font-size: 12px; font-weight: 600;
    }
    .theme-swatch:hover { transform: scale(1.04); }
    .theme-swatch.active { border-color: var(--border-bright) !important; box-shadow: 0 0 0 2px var(--accent); }
    .theme-swatch.cocky  { background:#100000; color:#f0f0f0; border-color:#8b0000; }
    .theme-swatch.jobs   { background:#fff; color:#1c1c1e; border-color:#d1d1d6; }
    .theme-swatch.woz    { background:#e8e8e8; color:#1a1a1a; border-color:#888; }
    .theme-swatch.terminal { background:#000; color:#00ee00; border-color:#00bb00; }
    .theme-swatch.oled   { background:#000; color:#fff; border-color:#333; }
    .swatch-dot { width: 28px; height: 28px; border-radius: 50%; margin-bottom: 2px; }
    .cocky  .swatch-dot { background: linear-gradient(135deg,#cc0000,#3d0000); }
    .jobs   .swatch-dot { background: linear-gradient(135deg,#007aff,#34c759); }
    .woz    .swatch-dot { background: linear-gradient(135deg,#e8e8e8,#888); border:1px solid #888; }
    .terminal .swatch-dot { background: radial-gradient(#00ff00,#004400); }
    .oled   .swatch-dot { background: linear-gradient(135deg,#fff,#333); }
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    #header {
      position: sticky; top: 0; z-index: 100;
      background: var(--header-bg);
      border-bottom: 2px solid var(--border-bright);
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 16px;
      box-shadow: 0 4px 24px var(--header-shadow);
    }
    #logo {
      font-family: var(--font-display);
      font-size: 26px; font-weight: 700; letter-spacing: 3px;
      color: var(--text); cursor: pointer;
      padding: 6px 12px; border-radius: 8px;
      border: none; background: transparent;
      display: flex; align-items: center; gap: 8px;
      transition: background 0.2s;
    }
    #logo:hover { background: rgba(128,128,128,0.15); }
    .gear-icon { font-size: 18px; opacity: 0.7; transition: transform 0.4s; display: inline-block; }
    #logo:hover .gear-icon { transform: rotate(60deg); opacity: 1; }
    #jsu-btn {
      display: flex; align-items: center; gap: 6px;
      background: var(--jsu-bg); color: var(--jsu-text);
      font-family: var(--font-display); font-weight: 700; font-size: 15px;
      padding: 7px 18px; border-radius: 999px;
      text-decoration: none; letter-spacing: 1px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.4);
      transition: transform 0.15s, box-shadow 0.15s;
    }
    #jsu-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(0,0,0,0.5); }

    /* ‚îÄ‚îÄ MAIN CONTAINER ‚îÄ‚îÄ */
    #main { display: flex; flex-direction: column; gap: 10px; padding: 12px; max-width: 1200px; margin: 0 auto; }

    /* ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ */
    #clock-card {
      background: var(--surface);
      border: 2px solid var(--border-bright);
      border-radius: var(--radius); padding: 20px;
      text-align: center;
      box-shadow: inset 0 0 40px var(--accent-glow);
    }
    #clock-time {
      font-family: var(--font-display);
      font-size: 48px; font-weight: 700; letter-spacing: 3px; line-height: 1;
      text-shadow: 0 0 20px var(--clock-glow);
    }
    #clock-date { color: var(--text-muted); font-size: 13px; margin-top: 5px; letter-spacing: 0.5px; }

    /* ‚îÄ‚îÄ FILTER CARD ‚îÄ‚îÄ */
    #filter-card {
      background: var(--surface);
      border: 2px solid var(--border-bright);
      border-radius: var(--radius); padding: 14px;
    }

    /* Day buttons */
    #day-grid {
      display: grid; grid-template-columns: repeat(5,1fr); gap: 6px; margin-bottom: 10px;
    }
    .day-btn {
      padding: 9px 4px;
      border-radius: calc(var(--radius) - 4px); border: 2px solid var(--border);
      background: transparent; color: var(--text-muted);
      font-family: var(--font-display); font-weight: 600; font-size: 14px;
      cursor: pointer; transition: all 0.15s; letter-spacing: 1px;
    }
    .day-btn:hover { border-color: var(--border-bright); color: var(--text); }
    .day-btn.active {
      background: var(--border-bright); border-color: var(--accent);
      color: var(--surface); box-shadow: 0 0 10px var(--accent-glow);
    }

    /* Building buttons */
    #building-row { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 8px; }
    .bldg-btn {
      padding: 6px 13px; border-radius: 20px;
      border: 2px solid var(--border); background: transparent; color: var(--text-muted);
      font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.15s;
      font-family: var(--font-body);
    }
    .bldg-btn:hover { border-color: var(--border-bright); color: var(--text); }
    .bldg-btn.active {
      background: var(--border-bright); border-color: var(--accent); color: var(--surface);
    }
    #show-more-btn {
      width: 100%; padding: 8px; border-radius: calc(var(--radius) - 4px);
      border: 2px solid var(--border); background: transparent; color: var(--text-dim);
      font-size: 13px; cursor: pointer; margin-bottom: 8px; transition: all 0.15s;
      font-family: var(--font-body);
    }
    #show-more-btn:hover { border-color: var(--border-bright); color: var(--text); }

    /* Availability filters */
    #avail-row { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 10px; }
    .avail-btn {
      padding: 6px 14px; border-radius: 20px;
      border: 2px solid var(--border); background: transparent; color: var(--text-muted);
      font-size: 13px; cursor: pointer; transition: all 0.15s; font-family: var(--font-body);
    }
    .avail-btn:hover { border-color: var(--border-bright); color: var(--text); }
    .avail-btn.active { border-color: var(--accent); color: var(--surface); background: var(--border-bright); }

    /* Search */
    #search-wrap { position: relative; }
    #search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-dim); font-size: 15px; pointer-events: none; }
    #search-input {
      width: 100%; background: var(--surface2);
      border: 2px solid var(--border); border-radius: calc(var(--radius) - 2px);
      padding: 10px 14px 10px 38px; color: var(--text); font-size: 14px;
      outline: none; transition: border 0.2s; font-family: var(--font-body);
    }
    #search-input:focus { border-color: var(--border-bright); }
    #search-input::placeholder { color: var(--text-dim); }

    /* ‚îÄ‚îÄ ROOM GRID ‚îÄ‚îÄ */
    #rooms-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(195px, 1fr));
      gap: 10px;
    }
    .room-card {
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: var(--radius); padding: 14px;
      cursor: pointer; transition: all 0.15s;
      position: relative;
    }
    .room-card:hover {
      border-color: var(--border-bright);
      transform: translateY(-2px);
      box-shadow: 0 6px 24px var(--accent-glow);
    }
    .room-card.pinned { border-color: var(--border-bright); background: var(--surface2); }
    .room-name {
      font-family: var(--font-display);
      font-size: 20px; font-weight: 700; margin-bottom: 4px; padding-right: 22px;
    }
    .room-status-free { color: var(--green); font-size: 13px; font-weight: 500; margin-bottom: 3px; }
    .room-status-occ { color: var(--red-alert); font-size: 13px; font-weight: 500; margin-bottom: 3px; }
    .room-course { color: var(--text-muted); font-size: 12px; }
    .room-count { color: var(--text-dim); font-size: 12px; margin-top: 4px; }
    .pin-btn {
      position: absolute; top: 10px; right: 10px;
      background: none; border: none; cursor: pointer;
      color: var(--text-dim); font-size: 17px; transition: color 0.15s; line-height: 1;
      padding: 2px;
    }
    .pin-btn:hover { color: #cc9900; }
    .pin-btn.pinned { color: #cc9900; }

    /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
    #empty-state { text-align: center; padding: 60px 20px; color: var(--text-dim); display: none; }
    #empty-state .icon { font-size: 48px; margin-bottom: 12px; }

    /* ‚îÄ‚îÄ DETAIL VIEW ‚îÄ‚îÄ */
    #detail-view {
      display: none; flex-direction: column;
      min-height: 100vh; background: var(--bg);
    }
    #detail-view.visible { display: flex; }
    #detail-header {
      position: sticky; top: 0; z-index: 100;
      background: var(--header-bg);
      border-bottom: 2px solid var(--border-bright);
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 16px;
      box-shadow: 0 4px 24px var(--header-shadow);
    }
    #back-btn {
      display: flex; align-items: center; gap: 6px;
      background: none; border: none; color: var(--text); font-size: 16px;
      cursor: pointer; padding: 6px 12px; border-radius: 8px;
      transition: background 0.2s; font-family: var(--font-body);
    }
    #back-btn:hover { background: var(--accent-glow); }
    #detail-pin-btn {
      background: var(--accent-glow); border: none; color: var(--text);
      font-size: 20px; cursor: pointer; padding: 6px 12px; border-radius: 8px;
      transition: background 0.2s;
    }
    #detail-pin-btn:hover { background: var(--border); }
    #detail-body { padding: 12px; display: flex; flex-direction: column; gap: 10px; max-width: 700px; margin: 0 auto; width: 100%; }
    #detail-info-card {
      background: var(--surface); border: 2px solid var(--border-bright);
      border-radius: var(--radius); padding: 20px;
    }
    #detail-room-name {
      font-family: var(--font-display); font-size: 34px; font-weight: 700; margin-bottom: 14px;
    }
    .status-box { border-radius: calc(var(--radius) - 2px); padding: 14px; }
    .status-box.free { background: rgba(34,197,94,0.1); border: 2px solid rgba(34,197,94,0.35); }
    .status-box.occ { background: rgba(239,68,68,0.1); border: 2px solid rgba(239,68,68,0.35); }
    .status-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; vertical-align: middle; }
    .status-dot.free { background: var(--green); }
    .status-dot.occ { background: var(--red-alert); animation: pulse 1.4s infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
    .status-label { font-weight: 600; font-size: 17px; }
    .status-label.free { color: var(--green); }
    .status-label.occ { color: var(--red-alert); }
    .status-sub { margin-top: 6px; color: var(--text); font-size: 14px; }
    .status-sub2 { color: var(--text-muted); font-size: 13px; margin-top: 2px; }
    #detail-schedule-card {
      background: var(--surface); border: 2px solid var(--border-bright);
      border-radius: var(--radius); padding: 20px;
    }
    .schedule-heading {
      font-family: var(--font-display); font-size: 16px; font-weight: 600;
      letter-spacing: 2px; color: var(--text-muted); margin-bottom: 14px;
    }
    .slot {
      background: var(--surface2); border: 2px solid var(--border);
      border-radius: calc(var(--radius) - 4px); padding: 12px; margin-bottom: 8px;
    }
    .slot.active { background: var(--accent-glow); border-color: var(--border-bright); }
    .slot.past { opacity: 0.4; }
    .slot-time { font-size: 12px; font-weight: 600; color: var(--text-muted); margin-bottom: 4px; }
    .slot-course { font-size: 15px; font-weight: 500; color: var(--text); }
    .slot-instructor { font-size: 12px; color: var(--text-dim); margin-top: 2px; }
    .now-badge {
      display: inline-block; background: var(--border-bright); color: var(--surface);
      font-size: 10px; font-weight: 700; padding: 2px 7px; border-radius: 20px;
      margin-left: 8px; letter-spacing: 0.5px; vertical-align: middle;
    }

    /* ‚îÄ‚îÄ SETTINGS VIEW ‚îÄ‚îÄ */
    #settings-view {
      display: none; flex-direction: column; min-height: 100vh; background: var(--bg);
    }
    #settings-view.visible { display: flex; }
    #settings-header {
      background: var(--header-bg);
      border-bottom: 2px solid var(--border-bright);
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 16px; box-shadow: 0 4px 24px var(--header-shadow);
    }
    #settings-title {
      font-family: var(--font-display); font-size: 22px; font-weight: 700; letter-spacing: 3px; color: var(--text);
    }
    #close-settings-btn {
      background: none; border: none; color: var(--text); font-size: 22px; cursor: pointer;
      padding: 4px 10px; border-radius: 6px; transition: background 0.2s;
    }
    #close-settings-btn:hover { background: var(--accent-glow); }
    #settings-body { padding: 16px; max-width: 600px; display: flex; flex-direction: column; gap: 10px; }
    .settings-card {
      background: var(--surface); border: 2px solid var(--border-bright);
      border-radius: var(--radius); padding: 20px;
    }
    .settings-card h3 {
      font-family: var(--font-display); font-size: 15px; letter-spacing: 2px;
      color: var(--text-muted); margin-bottom: 12px;
    }
    .settings-card p { color: var(--text-muted); font-size: 14px; line-height: 1.6; }
    .settings-stat { color: var(--text-dim); font-size: 13px; margin-top: 8px; }
    .pin-tag {
      display: inline-block; background: var(--accent-glow);
      border: 1px solid var(--border-bright); color: var(--text-muted);
      font-size: 12px; padding: 4px 10px; border-radius: 20px; margin: 3px;
    }
    #clear-pins-btn {
      background: var(--surface2); border: 1px solid var(--red-alert);
      color: var(--red-alert); padding: 7px 16px; border-radius: 8px;
      cursor: pointer; font-size: 13px; margin-top: 10px;
      transition: background 0.15s; font-family: var(--font-body);
    }
    #clear-pins-btn:hover { background: var(--border); }

    /* ‚îÄ‚îÄ BUILDING ORDER ‚îÄ‚îÄ */
    .bldg-order-list { list-style: none; display: flex; flex-direction: column; gap: 6px; }
    .bldg-order-item {
      display: flex; align-items: center; gap: 10px;
      background: var(--surface2); border: 2px solid var(--border);
      border-radius: calc(var(--radius) - 4px); padding: 10px 12px;
      cursor: grab; user-select: none; transition: border-color 0.15s, background 0.15s;
    }
    .bldg-order-item:active { cursor: grabbing; }
    .bldg-order-item.drag-over { border-color: var(--accent); background: var(--accent-glow); }
    .bldg-order-item.dragging { opacity: 0.4; }
    .drag-handle { color: var(--text-dim); font-size: 16px; cursor: grab; flex-shrink: 0; }
    .bldg-order-name { font-family: var(--font-display); font-size: 16px; font-weight: 600; flex: 1; color: var(--text); }
    .bldg-order-code { color: var(--text-dim); font-size: 12px; }
    .bldg-move-btns { display: flex; flex-direction: column; gap: 2px; }
    .bldg-move-btn {
      background: var(--border); border: none; color: var(--text-muted);
      width: 22px; height: 18px; border-radius: 4px; cursor: pointer;
      font-size: 10px; display: flex; align-items: center; justify-content: center;
      transition: background 0.15s;
    }
    .bldg-move-btn:hover { background: var(--border-bright); color: var(--surface); }
    #reset-order-btn {
      background: transparent; border: 1px solid var(--border);
      color: var(--text-dim); padding: 6px 14px; border-radius: 8px;
      cursor: pointer; font-size: 12px; margin-top: 10px;
      transition: all 0.15s; font-family: var(--font-body);
    }
    #reset-order-btn:hover { border-color: var(--border-bright); color: var(--text); }

    /* ‚îÄ‚îÄ MISC ‚îÄ‚îÄ */
    .divider { border: none; border-top: 1px solid var(--border); margin: 14px 0; }
    .count-badge {
      display: inline-block; background: var(--border); color: var(--text-muted);
      font-size: 11px; padding: 2px 7px; border-radius: 10px; margin-left: 6px;
    }
    #main-view { display: block; }
    #main-view.hidden { display: none; }

    @media (max-width: 480px) {
      #clock-time { font-size: 36px; }
      #rooms-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê MAIN VIEW ‚ïê‚ïê‚ïê -->
<div id="main-view">
  <div id="header">
    <button id="logo" onclick="showSettings()">TSC <span class="gear-icon">‚öô</span></button>
    <a id="jsu-btn" href="https://www.jsu.edu" target="_blank" rel="noopener noreferrer">
      JSU <span>üêî</span>
    </a>
  </div>

  <div id="main">
    <!-- Clock -->
    <div id="clock-card">
      <div id="clock-time">--:--:-- --</div>
      <div id="clock-date"></div>
    </div>

    <!-- Filters -->
    <div id="filter-card">
      <div id="day-grid">
        <button class="day-btn" data-day="Monday">Mon</button>
        <button class="day-btn" data-day="Tuesday">Tue</button>
        <button class="day-btn" data-day="Wednesday">Wed</button>
        <button class="day-btn" data-day="Thursday">Thu</button>
        <button class="day-btn" data-day="Friday">Fri</button>
      </div>

      <div id="building-row"></div>
      <button id="show-more-btn" onclick="toggleShowMore()"></button>

      <div id="avail-row">
        <button class="avail-btn active" data-filter="all">All Rooms</button>
        <button class="avail-btn" data-filter="available">Available Now</button>
        <button class="avail-btn" data-filter="free30">Free 30+ min</button>
        <button class="avail-btn" data-filter="free60">Free 60+ min</button>
      </div>

      <div id="search-wrap">
        <span id="search-icon">üîç</span>
        <input id="search-input" type="text" placeholder="Search rooms..." oninput="renderRooms()">
      </div>
    </div>

    <!-- Rooms -->
    <div id="rooms-grid"></div>
    <div id="empty-state">
      <div class="icon">üîç</div>
      <div>No rooms match your filters</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê DETAIL VIEW ‚ïê‚ïê‚ïê -->
<div id="detail-view" class="hidden">
  <div id="detail-header">
    <button id="back-btn" onclick="hideDetail()">‚Üê Back</button>
    <button id="detail-pin-btn" onclick="toggleDetailPin()">‚òÜ</button>
  </div>
  <div id="detail-body">
    <div id="detail-info-card">
      <div id="detail-room-name"></div>
      <div id="detail-status-box"></div>
    </div>
    <div id="detail-schedule-card">
      <div class="schedule-heading" id="detail-schedule-heading">SCHEDULE</div>
      <div id="detail-slots"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê SETTINGS VIEW ‚ïê‚ïê‚ïê -->
<div id="settings-view" class="hidden">
  <div id="settings-header">
    <span id="settings-title">SETTINGS</span>
    <button id="close-settings-btn" onclick="hideSettings()">‚úï</button>
  </div>
  <div id="settings-body">
    <div class="settings-card">
      <h3>ABOUT TSC ROOM TRACKER</h3>
      <p>Real-time room availability for Jacksonville State University campus buildings. Data sourced from the Spring 2026 class schedule.</p>
      <div class="divider"></div>
      <div class="settings-stat" id="stats-line"></div>
    </div>
    <div class="settings-card">
      <h3>THEME</h3>
      <div class="theme-grid">
        <div class="theme-swatch cocky" data-theme-name="cocky" onclick="setTheme('cocky')">
          <div class="swatch-dot"></div>Stay Cocky
        </div>
        <div class="theme-swatch jobs" data-theme-name="jobs" onclick="setTheme('jobs')">
          <div class="swatch-dot"></div>Jobs
        </div>
        <div class="theme-swatch woz" data-theme-name="woz" onclick="setTheme('woz')">
          <div class="swatch-dot"></div>Woz
        </div>
        <div class="theme-swatch terminal" data-theme-name="terminal" onclick="setTheme('terminal')">
          <div class="swatch-dot"></div>Terminal
        </div>
        <div class="theme-swatch oled" data-theme-name="oled" onclick="setTheme('oled')">
          <div class="swatch-dot"></div>OLED
        </div>
      </div>
    </div>
    <div class="settings-card">
      <h3>PINNED ROOMS <span class="count-badge" id="pin-count">0</span></h3>
      <div id="pinned-list"></div>
      <button id="clear-pins-btn" onclick="clearPins()" style="display:none">Clear All Pins</button>
    </div>
    <div class="settings-card">
      <h3>BUILDING ORDER</h3>
      <p style="color:var(--text-dim);font-size:12px;margin-bottom:12px;">Drag or use arrows to reorder. First 7 shown by default.</p>
      <ul class="bldg-order-list" id="bldg-order-list"></ul>
      <button id="reset-order-btn" onclick="resetBldgOrder()">Reset to Default</button>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SCHEDULE DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SCHEDULE = {"AH":{"200D":[{"day":"Thursday","s":"13:00","e":"16:00","course":"Applied Behavior Analysis II","instr":"pmckerchar"},{"day":"Tuesday","s":"14:00","e":"17:00","course":"Experimental Analysis of Behavior","instr":"rnall"},{"day":"Wednesday","s":"14:00","e":"17:00","course":"Single-Subject Research Methods","instr":"crrenda"}],"021":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Conditioning and Learning","instr":"tmckerchar"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Conditioning and Learning","instr":"tmckerchar"},{"day":"Wednesday","s":"14:00","e":"17:00","course":"BCBA Test Content Review","instr":"mbayles"}],"149":[{"day":"Monday","s":"14:30","e":"16:00","course":"Manufacturing Fundamentals","instr":"artpov"},{"day":"Thursday","s":"09:15","e":"10:45","course":"Manufacturing Fundamentals","instr":"artpov"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Manufacturing Fundamentals","instr":"artpov"},{"day":"Wednesday","s":"14:30","e":"16:00","course":"Manufacturing Fundamentals","instr":"artpov"}],"157":[{"day":"Monday","s":"08:45","e":"10:45","course":"Digital Circuits","instr":"bekhouch"},{"day":"Monday","s":"11:00","e":"12:30","course":"AC/DC Circuits","instr":"bekhouch"},{"day":"Thursday","s":"09:15","e":"10:45","course":"AC/DC Circuits","instr":"bekhouch"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"AC/DC Circuits","instr":"bekhouch"},{"day":"Wednesday","s":"08:45","e":"10:45","course":"Digital Circuits","instr":"bekhouch"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"AC/DC Circuits","instr":"bekhouch"}],"012":[{"day":"Friday","s":"10:00","e":"11:00","course":"Human Development","instr":"msreed"},{"day":"Friday","s":"11:15","e":"12:15","course":"Abnormal Psychology","instr":"msreed"},{"day":"Monday","s":"08:45","e":"09:45","course":"Principles of Psychology","instr":"rconroy"},{"day":"Monday","s":"10:00","e":"11:00","course":"Human Development","instr":"msreed"},{"day":"Monday","s":"11:15","e":"12:15","course":"Abnormal Psychology","instr":"msreed"},{"day":"Thursday","s":"14:30","e":"16:00","course":"Abnormal Psychology","instr":"msreed"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Abnormal Psychology","instr":"msreed"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Principles of Psychology","instr":"rconroy"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Human Development","instr":"msreed"},{"day":"Wednesday","s":"11:15","e":"12:15","course":"Abnormal Psychology","instr":"msreed"}],"013":[{"day":"Friday","s":"08:45","e":"09:45","course":"Applied Behavior Analysis I","instr":"sdanderson"},{"day":"Monday","s":"08:45","e":"09:45","course":"Applied Behavior Analysis I","instr":"sdanderson"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Applied Behavior Analysis I","instr":"sdanderson"}],"107":[{"day":"Friday","s":"08:45","e":"09:45","course":"Theories of Personality","instr":"cmorley"},{"day":"Monday","s":"08:45","e":"09:45","course":"Theories of Personality","instr":"cmorley"},{"day":"Monday","s":"13:00","e":"14:30","course":"Substance Abuse Studies","instr":"rconroy"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Theories of Personality","instr":"cmorley"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Substance Abuse Studies","instr":"rconroy"}],"113":[{"day":"Friday","s":"10:00","e":"11:00","course":"Conditioning and Learning","instr":"tmckerchar"},{"day":"Monday","s":"10:00","e":"11:00","course":"Conditioning and Learning","instr":"tmckerchar"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Conditioning and Learning","instr":"tmckerchar"}],"114":[{"day":"Friday","s":"08:45","e":"09:45","course":"Psychology of Personality","instr":"dtcarroll"},{"day":"Friday","s":"10:00","e":"11:00","course":"Organizational Behavior & Leadership","instr":"mebeasley"},{"day":"Monday","s":"08:45","e":"09:45","course":"Psychology of Personality","instr":"dtcarroll"},{"day":"Monday","s":"10:00","e":"11:00","course":"Organizational Behavior & Leadership","instr":"mebeasley"},{"day":"Thursday","s":"09:15","e":"10:45","course":"Organizational Behavior & Leadership","instr":"mebeasley"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Organizational Behavior & Leadership","instr":"mebeasley"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Psychology of Personality","instr":"dtcarroll"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Organizational Behavior & Leadership","instr":"mebeasley"}],"116":[{"day":"Friday","s":"10:00","e":"11:00","course":"Psychology of Learning","instr":"pmckerchar"},{"day":"Monday","s":"10:00","e":"11:00","course":"Psychology of Learning","instr":"pmckerchar"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Psychology of Learning","instr":"pmckerchar"}],"118":[{"day":"Friday","s":"10:00","e":"11:00","course":"Cognitive Psychology","instr":"dtcarroll"},{"day":"Monday","s":"10:00","e":"11:00","course":"Cognitive Psychology","instr":"dtcarroll"},{"day":"Thursday","s":"11:00","e":"12:30","course":"Cognitive Psychology","instr":"dtcarroll"},{"day":"Thursday","s":"14:30","e":"16:00","course":"Psychology Research Methods","instr":"dtcarroll"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Cognitive Psychology","instr":"dtcarroll"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Psychology Research Methods","instr":"dtcarroll"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Cognitive Psychology","instr":"dtcarroll"}],"120":[{"day":"Friday","s":"08:45","e":"09:45","course":"AE - Eyarbrough","instr":"eyarbrough"},{"day":"Monday","s":"08:45","e":"09:45","course":"AE - Eyarbrough","instr":"eyarbrough"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"AE - Eyarbrough","instr":"eyarbrough"}],"161":[{"day":"Friday","s":"11:15","e":"12:15","course":"Criminology","instr":"twinters"},{"day":"Monday","s":"11:15","e":"12:15","course":"Criminology","instr":"twinters"},{"day":"Wednesday","s":"11:15","e":"12:15","course":"Criminology","instr":"twinters"}],"214":[{"day":"Friday","s":"10:00","e":"11:00","course":"Principles of Psychology","instr":"mebeasley"},{"day":"Monday","s":"10:00","e":"11:00","course":"Principles of Psychology","instr":"mebeasley"},{"day":"Thursday","s":"14:30","e":"16:00","course":"Organizational Behavior","instr":"mebeasley"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Organizational Behavior","instr":"mebeasley"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Principles of Psychology","instr":"mebeasley"}],"216":[{"day":"Friday","s":"10:00","e":"11:00","course":"Intro to Counseling","instr":"cmorley"},{"day":"Monday","s":"10:00","e":"11:00","course":"Intro to Counseling","instr":"cmorley"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Intro to Counseling","instr":"cmorley"}],"218":[{"day":"Friday","s":"10:00","e":"11:00","course":"Techniques in Health & PE","instr":"akpeterson"},{"day":"Monday","s":"10:00","e":"11:00","course":"Techniques in Health & PE","instr":"akpeterson"},{"day":"Thursday","s":"09:15","e":"10:45","course":"Techniques in Health & PE","instr":"akpeterson"},{"day":"Thursday","s":"11:00","e":"12:30","course":"Rec Sports Prog & Event Mgmt","instr":"lcolvin"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Techniques in Health & PE","instr":"akpeterson"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Rec Sports Prog & Event Mgmt","instr":"lcolvin"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Techniques in Health & PE","instr":"akpeterson"}],"220":[{"day":"Monday","s":"08:45","e":"09:45","course":"Developmental Psychology","instr":"msreed"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Developmental Psychology","instr":"msreed"}],"221":[{"day":"Monday","s":"11:00","e":"12:30","course":"Foundations of Sport","instr":"lcolvin"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Foundations of Sport","instr":"lcolvin"}],"223":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Intro to Systems Theory MFT","instr":"cmorley"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Intro to Systems Theory MFT","instr":"cmorley"}],"253":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Intro to Guidance and Counseling","instr":"cmorley"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Intro to Guidance and Counseling","instr":"cmorley"}],"256":[{"day":"Monday","s":"11:00","e":"12:30","course":"Practicum in Counseling","instr":"jhudson"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Practicum in Counseling","instr":"jhudson"}],"257":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Professional Ethics in Counseling","instr":"rconroy"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Professional Ethics in Counseling","instr":"rconroy"}],"271":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Career Development & Counseling","instr":"rconroy"},{"day":"Tuesday","s":"16:15","e":"19:15","course":"Career Development & Counseling","instr":"rconroy"}],"280":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Internship in Counseling","instr":"jhudson"}],"290":[{"day":"Monday","s":"16:15","e":"19:15","course":"Clinical Mental Health Counseling","instr":"jhudson"}],"343":[{"day":"Monday","s":"16:15","e":"19:15","course":"Counseling Children & Adolescents","instr":"jhudson"}]},"BH":{"104":[{"day":"Monday","s":"13:00","e":"14:30","course":"Intro to Business","instr":"jsparks"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Intro to Business","instr":"jsparks"}],"106":[{"day":"Friday","s":"08:45","e":"09:45","course":"Business Communication (WI)","instr":"asullivan"},{"day":"Monday","s":"08:45","e":"09:45","course":"Business Communication (WI)","instr":"asullivan"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Business Communication (WI)","instr":"asullivan"}],"112":[{"day":"Monday","s":"11:00","e":"12:30","course":"Intro to Business","instr":"jsparks"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Intro to Business","instr":"jsparks"}],"202":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Real Estate Fundamentals","instr":"lmcbride"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Real Estate Fundamentals","instr":"lmcbride"}],"206":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Real Estate Law","instr":"lmcbride"}],"208":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Management & Organizational Behavior","instr":"lknowles"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Management & Organizational Behavior","instr":"lknowles"}],"210":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Business Communication (WI)","instr":"asullivan"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Business Communication (WI)","instr":"asullivan"}],"215":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Advertising","instr":"asullivan"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Advertising","instr":"asullivan"}],"218":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Legal Environment of Business","instr":"lknowles"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Legal Environment of Business","instr":"lknowles"}],"224":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Applied Marketing Strategies (WI)","instr":"asullivan"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Applied Marketing Strategies (WI)","instr":"asullivan"}],"228":[{"day":"Thursday","s":"09:15","e":"10:45","course":"International Business","instr":"lknowles"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"International Business","instr":"lknowles"}]},"CEPS":{"103":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Intro to Inclusive ECE","instr":"cbaxter"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Intro to Inclusive ECE","instr":"cbaxter"}],"105":[{"day":"Monday","s":"13:00","e":"14:30","course":"Practical Resources for ECE","instr":"cbaxter"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Practical Resources for ECE","instr":"cbaxter"}],"107":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Curriculum Design in ECE","instr":"cbaxter"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Curriculum Design in ECE","instr":"cbaxter"}],"130":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Instructional Design & Technology","instr":"lbritton"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Instructional Design & Technology","instr":"lbritton"}],"213":[{"day":"Monday","s":"13:00","e":"14:30","course":"Foundations of Education","instr":"dbowling"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Foundations of Education","instr":"dbowling"}],"218":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Education and Society","instr":"dbowling"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Education and Society","instr":"dbowling"}],"220A":[{"day":"Friday","s":"08:45","e":"09:45","course":"Human Growth & Development","instr":"sgibbs"},{"day":"Monday","s":"08:45","e":"09:45","course":"Human Growth & Development","instr":"sgibbs"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Human Growth & Development","instr":"sgibbs"}],"221":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Special Education","instr":"slackson"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Special Education","instr":"slackson"}],"222":[{"day":"Friday","s":"10:00","e":"11:00","course":"Intro to Secondary Education","instr":"rsmith"},{"day":"Monday","s":"10:00","e":"11:00","course":"Intro to Secondary Education","instr":"rsmith"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Intro to Secondary Education","instr":"rsmith"}],"223":[{"day":"Friday","s":"08:45","e":"09:45","course":"Intro to Early Childhood Education","instr":"cbaxter"},{"day":"Monday","s":"08:45","e":"09:45","course":"Intro to Early Childhood Education","instr":"cbaxter"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Intro to Early Childhood Education","instr":"cbaxter"}],"229":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Classroom Management","instr":"rsmith"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Classroom Management","instr":"rsmith"}],"231":[{"day":"Friday","s":"11:15","e":"12:15","course":"Educational Psychology","instr":"sgibbs"},{"day":"Monday","s":"11:15","e":"12:15","course":"Educational Psychology","instr":"sgibbs"},{"day":"Wednesday","s":"11:15","e":"12:15","course":"Educational Psychology","instr":"sgibbs"}]},"CFAF":{"E138":[{"day":"Friday","s":"08:45","e":"09:45","course":"Voice Class","instr":"ebmorrison"},{"day":"Monday","s":"08:45","e":"09:45","course":"Voice Class","instr":"ebmorrison"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Voice Class","instr":"ebmorrison"}],"E222":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Music Composition I","instr":"twall"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Music Composition I","instr":"twall"}],"E237":[{"day":"Friday","s":"08:45","e":"09:45","course":"Music History I","instr":"mpbarnhardt"},{"day":"Monday","s":"08:45","e":"09:45","course":"Music History I","instr":"mpbarnhardt"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Music History I","instr":"mpbarnhardt"}],"E250":[{"day":"Friday","s":"10:00","e":"11:00","course":"Conducting I","instr":"ebmorrison"},{"day":"Monday","s":"10:00","e":"11:00","course":"Conducting I","instr":"ebmorrison"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Conducting I","instr":"ebmorrison"}],"N102":[{"day":"Monday","s":"08:45","e":"09:45","course":"Sight Singing I","instr":"ebmorrison"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Sight Singing I","instr":"ebmorrison"}]},"HH":{"103":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Principles of Management","instr":"cbjones"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Principles of Management","instr":"cbjones"}],"107":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Principles of Management","instr":"cbjones"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Principles of Management","instr":"cbjones"}],"204":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Operations Management","instr":"cbjones"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Operations Management","instr":"cbjones"}],"224":[{"day":"Monday","s":"13:00","e":"14:30","course":"Intro to Emergency Management","instr":"mmurphy"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Intro to Emergency Management","instr":"mmurphy"}]},"LIB":{"MLB":[{"day":"Monday","s":"13:45","e":"14:45","course":"Honors Lecture","instr":"kwestbrooks1"}],"UL107":[{"day":"Friday","s":"08:45","e":"09:45","course":"Foundations of Library & Info Science","instr":"library"},{"day":"Monday","s":"08:45","e":"09:45","course":"Foundations of Library & Info Science","instr":"library"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Foundations of Library & Info Science","instr":"library"}],"UL210":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Information Literacy Instruction","instr":"library"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Information Literacy Instruction","instr":"library"}],"UL325":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Digital Libraries","instr":"library"}]},"MAH":{"102":[{"day":"Monday","s":"15:00","e":"16:30","course":"BY293","instr":""}],"105":[{"day":"Wednesday","s":"11:00","e":"13:00","course":"GL244","instr":""},{"day":"Wednesday","s":"13:45","e":"15:45","course":"GY252","instr":""},{"day":"Wednesday","s":"17:30","e":"19:30","course":"GY253","instr":""}],"111":[{"day":"Monday","s":"07:45","e":"09:45","course":"BY434","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"BY406","instr":""},{"day":"Monday","s":"13:45","e":"15:45","course":"BY419","instr":""}],"114":[{"day":"Thursday","s":"09:15","e":"10:45","course":"UH 320","instr":"lbobo"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"UH 320","instr":"lbobo"}],"122":[{"day":"Monday","s":"08:45","e":"09:45","course":"BY322","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"BY324","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"BY283","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"BY122","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"BY283","instr":""},{"day":"Monday","s":"15:00","e":"16:30","course":"BY101","instr":""}],"130":[{"day":"Monday","s":"08:45","e":"09:45","course":"BY264","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"BY263","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"BY263","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"BY123","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"BY121","instr":""}],"203":[{"day":"Monday","s":"11:15","e":"12:15","course":"BY340","instr":""},{"day":"Wednesday","s":"16:15","e":"19:15","course":"GIS420","instr":""}],"219":[{"day":"Monday","s":"08:45","e":"09:45","course":"PHS491","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"PHS371","instr":""},{"day":"Monday","s":"13:45","e":"15:45","course":"PHS222","instr":""}],"234":[{"day":"Monday","s":"08:45","e":"09:45","course":"PHS201","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"GY220","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"CY232","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"GL241","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"PHS201","instr":""}],"307":[{"day":"Monday","s":"08:45","e":"09:45","course":"AN224","instr":""},{"day":"Monday","s":"10:00","e":"10:59","course":"GL242","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"GY366","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"AN345","instr":""}],"319":[{"day":"Monday","s":"10:00","e":"11:00","course":"PHS202","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"PHS202","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"CY106","instr":""}],"332":[{"day":"Monday","s":"08:45","e":"09:45","course":"CY363","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"CY450","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"GY250","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"GY251","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"BY123","instr":""},{"day":"Monday","s":"15:00","e":"16:30","course":"CY231","instr":""}],"336":[{"day":"Monday","s":"08:45","e":"09:45","course":"BY121","instr":""},{"day":"Monday","s":"10:00","e":"11:00","course":"BY101","instr":""},{"day":"Monday","s":"11:15","e":"12:15","course":"BY101","instr":""},{"day":"Monday","s":"12:30","e":"13:30","course":"BY102","instr":""},{"day":"Monday","s":"13:45","e":"14:45","course":"BY102","instr":""},{"day":"Monday","s":"15:00","e":"16:30","course":"BY472","instr":""}]},"MB":{"100":[{"day":"Thursday","s":"12:45","e":"14:15","course":"Data Analytics for Accounting (WI)","instr":"jzanzig"},{"day":"Tuesday","s":"12:45","e":"14:15","course":"Data Analytics for Accounting (WI)","instr":"jzanzig"}],"102":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Corporate Finance","instr":"dmccrary"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Corporate Finance","instr":"dmccrary"}],"106":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Principles of Finance","instr":"dmccrary"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Principles of Finance","instr":"dmccrary"}],"200":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Principles of Accounting I","instr":"tcollum"},{"day":"Thursday","s":"12:45","e":"14:15","course":"Principles of Accounting I","instr":"jsudduth"},{"day":"Thursday","s":"14:30","e":"16:00","course":"Principles of Accounting II","instr":"ngrady"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Principles of Accounting I","instr":"tcollum"},{"day":"Tuesday","s":"12:45","e":"14:15","course":"Principles of Accounting I","instr":"jsudduth"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Principles of Accounting II","instr":"ngrady"}],"204":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Intermediate Accounting I","instr":"tcollum"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Intermediate Accounting I","instr":"tcollum"}],"206":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Intermediate Accounting II","instr":"tcollum"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Intermediate Accounting II","instr":"tcollum"}],"208":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Auditing","instr":"jzanzig"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Auditing","instr":"jzanzig"}],"220":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Cost Accounting","instr":"jsudduth"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Cost Accounting","instr":"jsudduth"}],"224":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Income Tax I","instr":"ngrady"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Income Tax I","instr":"ngrady"}]},"MCG":{"101":[{"day":"Thursday","s":"12:30","e":"13:30","course":"Biology for Health Careers","instr":"aelovera"},{"day":"Tuesday","s":"12:30","e":"13:30","course":"Biology for Health Careers","instr":"aelovera"}],"104":[{"day":"Monday","s":"13:00","e":"14:30","course":"Nutrition","instr":"aelovera"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Nutrition","instr":"aelovera"}],"111":[{"day":"Thursday","s":"11:00","e":"12:30","course":"General Microbiology","instr":"aelovera"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"General Microbiology","instr":"aelovera"}],"120":[{"day":"Monday","s":"11:00","e":"12:30","course":"Anatomy & Physiology I","instr":"aelovera"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Anatomy & Physiology I","instr":"aelovera"}],"227":[{"day":"Monday","s":"18:15","e":"19:45","course":"General Genetics","instr":"aelovera"}],"245":[{"day":"Monday","s":"16:15","e":"19:15","course":"General Genetics","instr":"aelovera"}]},"MH":{"106":[{"day":"Friday","s":"08:45","e":"09:45","course":"World Geography","instr":"lknight"},{"day":"Monday","s":"08:45","e":"09:45","course":"World Geography","instr":"lknight"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"World Geography","instr":"lknight"}],"109":[{"day":"Friday","s":"11:15","e":"12:15","course":"World History I","instr":"lknight"},{"day":"Monday","s":"11:15","e":"12:15","course":"World History I","instr":"lknight"},{"day":"Wednesday","s":"11:15","e":"12:15","course":"World History I","instr":"lknight"}],"112":[{"day":"Friday","s":"10:00","e":"11:00","course":"World History II","instr":"lknight"},{"day":"Monday","s":"10:00","e":"11:00","course":"World History II","instr":"lknight"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"World History II","instr":"lknight"}],"117":[{"day":"Thursday","s":"11:00","e":"12:30","course":"US History Since 1877","instr":"dbutler"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"US History Since 1877","instr":"dbutler"}],"202":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Poli Sci Research Methods","instr":"mmurphy"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Poli Sci Research Methods","instr":"mmurphy"}],"207":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Intro to Political Science","instr":"mmurphy"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Intro to Political Science","instr":"mmurphy"}],"213":[{"day":"Friday","s":"08:45","e":"09:45","course":"Global Issues","instr":"mmurphy"},{"day":"Monday","s":"08:45","e":"09:45","course":"Global Issues","instr":"mmurphy"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Global Issues","instr":"mmurphy"}],"217":[{"day":"Thursday","s":"14:30","e":"16:00","course":"American National Government","instr":"mmurphy"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"American National Government","instr":"mmurphy"}],"226":[{"day":"Monday","s":"13:00","e":"14:30","course":"World Regional Geography","instr":"lknight"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"World Regional Geography","instr":"lknight"}],"301":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Historiography","instr":"dbutler"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Historiography","instr":"dbutler"}]},"RH":{"105":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Intro to Sociology","instr":"twinters"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Intro to Sociology","instr":"twinters"}],"109":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Intro to Sociology","instr":"twinters"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Intro to Sociology","instr":"twinters"}],"113":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Social Problems","instr":"twinters"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Social Problems","instr":"twinters"}],"212":[{"day":"Monday","s":"11:00","e":"12:30","course":"Marriage and the Family","instr":"twinters"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Marriage and the Family","instr":"twinters"}],"224":[{"day":"Monday","s":"13:00","e":"14:30","course":"Juvenile Delinquency","instr":"twinters"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Juvenile Delinquency","instr":"twinters"}]},"RWB":{"101":[{"day":"Friday","s":"08:45","e":"09:45","course":"Intro to Mass Communication","instr":"jwoods"},{"day":"Monday","s":"08:45","e":"09:45","course":"Intro to Mass Communication","instr":"jwoods"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Intro to Mass Communication","instr":"jwoods"}],"103":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Digital Media Production","instr":"jwoods"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Digital Media Production","instr":"jwoods"}],"105":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Radio and Audio Production","instr":"jwoods"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Radio and Audio Production","instr":"jwoods"}],"201":[{"day":"Friday","s":"10:00","e":"11:00","course":"Writing for the Media","instr":"jwoods"},{"day":"Monday","s":"10:00","e":"11:00","course":"Writing for the Media","instr":"jwoods"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Writing for the Media","instr":"jwoods"}],"203":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Journalism","instr":"jwoods"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Journalism","instr":"jwoods"}],"205":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Public Relations","instr":"jwoods"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Public Relations","instr":"jwoods"}]},"SC":{"122":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Acting I","instr":"cconover"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Acting I","instr":"cconover"}],"135":[{"day":"Friday","s":"08:45","e":"09:45","course":"Intro to Dance","instr":"awoodward"},{"day":"Monday","s":"08:45","e":"09:45","course":"Intro to Dance","instr":"awoodward"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Intro to Dance","instr":"awoodward"}],"237":[{"day":"Friday","s":"10:00","e":"11:00","course":"Costume Design I","instr":"rblades"},{"day":"Monday","s":"10:00","e":"11:00","course":"Costume Design I","instr":"rblades"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"Costume Design I","instr":"rblades"}],"421":[{"day":"Thursday","s":"09:15","e":"10:45","course":"English Grammar","instr":"kmills"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"English Grammar","instr":"kmills"}],"426":[{"day":"Friday","s":"10:00","e":"11:00","course":"British Literature I","instr":"rdaniels"},{"day":"Monday","s":"10:00","e":"11:00","course":"British Literature I","instr":"rdaniels"},{"day":"Wednesday","s":"10:00","e":"11:00","course":"British Literature I","instr":"rdaniels"}],"428":[{"day":"Friday","s":"11:15","e":"12:15","course":"British Literature II","instr":"rdaniels"},{"day":"Monday","s":"11:15","e":"12:15","course":"British Literature II","instr":"rdaniels"},{"day":"Wednesday","s":"11:15","e":"12:15","course":"British Literature II","instr":"rdaniels"}],"430":[{"day":"Friday","s":"08:45","e":"09:45","course":"American Literature I","instr":"jbaker"},{"day":"Monday","s":"08:45","e":"09:45","course":"American Literature I","instr":"jbaker"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"American Literature I","instr":"jbaker"}],"432":[{"day":"Thursday","s":"11:00","e":"12:30","course":"American Literature II","instr":"jbaker"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"American Literature II","instr":"jbaker"}],"435":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Shakespeare","instr":"jbaker"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Shakespeare","instr":"jbaker"}],"441":[{"day":"Monday","s":"13:00","e":"14:30","course":"Creative Writing: Fiction","instr":"jbaker"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Creative Writing: Fiction","instr":"jbaker"}],"445":[{"day":"Monday","s":"11:00","e":"12:30","course":"Technical Writing","instr":"kmills"},{"day":"Wednesday","s":"11:00","e":"12:30","course":"Technical Writing","instr":"kmills"}]},"SCX":{"126A":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Pathophysiology","instr":"nursing"}],"128":[{"day":"Thursday","s":"16:15","e":"19:15","course":"Pharmacology","instr":"nursing"}],"138":[{"day":"Tuesday","s":"16:15","e":"19:15","course":"Adult Health Nursing I","instr":"nursing"}],"144":[{"day":"Monday","s":"16:15","e":"19:15","course":"Mental Health Nursing","instr":"nursing"}],"236":[{"day":"Monday","s":"16:15","e":"19:15","course":"Adult Health Nursing II","instr":"nursing"}]},"SEL":{"104":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Intro to Kinesiology","instr":"akpeterson"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Intro to Kinesiology","instr":"akpeterson"}],"106":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Exercise Physiology","instr":"akpeterson"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Exercise Physiology","instr":"akpeterson"}],"116":[{"day":"Monday","s":"13:00","e":"14:30","course":"Intro to Recreation & Leisure Services","instr":"lcolvin"},{"day":"Wednesday","s":"13:00","e":"14:30","course":"Intro to Recreation & Leisure Services","instr":"lcolvin"}]},"STE":{"107":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Contemporary Mathematics","instr":"bcleveland"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Contemporary Mathematics","instr":"bcleveland"}],"109":[{"day":"Thursday","s":"11:00","e":"12:30","course":"College Algebra","instr":"bcleveland"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"College Algebra","instr":"bcleveland"}],"115":[{"day":"Friday","s":"08:45","e":"09:45","course":"Precalculus","instr":"bcleveland"},{"day":"Monday","s":"08:45","e":"09:45","course":"Precalculus","instr":"bcleveland"},{"day":"Wednesday","s":"08:45","e":"09:45","course":"Precalculus","instr":"bcleveland"}],"121":[{"day":"Thursday","s":"14:30","e":"16:00","course":"Calculus I","instr":"bcleveland"},{"day":"Tuesday","s":"14:30","e":"16:00","course":"Calculus I","instr":"bcleveland"}],"131":[{"day":"Thursday","s":"11:00","e":"12:30","course":"Calculus II","instr":"bcleveland"},{"day":"Tuesday","s":"11:00","e":"12:30","course":"Calculus II","instr":"bcleveland"}],"241":[{"day":"Thursday","s":"09:15","e":"10:45","course":"Differential Equations","instr":"bcleveland"},{"day":"Tuesday","s":"09:15","e":"10:45","course":"Differential Equations","instr":"bcleveland"}]}};

const BLDG_NAMES = {AH:"Ayers",BH:"Brewer",CEPS:"CEPS",CFAF:"Fine Arts",HH:"Hammond",LIB:"HCL",MAH:"MAH",MB:"Merrill",MCG:"McGee",MH:"Mason",RH:"Rowe",RWB:"RW Building",SC:"Stone Center",SCX:"South Complex",SEL:"Self",STE:"Stephenson"};
const PRIMARY = ["AH","BH","CEPS","CFAF","HH","LIB","MAH"]; // kept for legacy reference only
const ALL_BLDGS = Object.keys(BLDG_NAMES);

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let state = {
  day: getCurrentDay(),
  selBuilding: "AH",
  bldgOrder: [...ALL_BLDGS],
  showMore: false,
  filter: "all",
  pinned: [],
  theme: "cocky",
  detailRoom: null,
  clockInterval: null
};

function getCurrentDay() {
  const m = {1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday"};
  return m[new Date().getDay()] || "Monday";
}

function toMins(t) {
  if (!t) return 0;
  const [h,m] = t.split(":").map(Number);
  return h*60+(m||0);
}

function fmt12(t) {
  if (!t) return "";
  const [h,m] = t.split(":").map(Number);
  const ap = h>=12?"PM":"AM", hr=h%12||12;
  return `${hr}:${String(m).padStart(2,"0")} ${ap}`;
}

function nowStr() {
  const d = new Date();
  return `${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
}

function getStatus(bldg, room, day) {
  const slots = (SCHEDULE[bldg]?.[room]||[]).filter(s=>s.day===day);
  const cur = toMins(nowStr());
  const active = slots.find(s=>cur>=toMins(s.s)&&cur<toMins(s.e));
  if (active) return {occupied:true, until:active.e, course:active.course, instr:active.instr};
  const next = slots.filter(s=>toMins(s.s)>cur).sort((a,b)=>toMins(a.s)-toMins(b.s))[0];
  if (next) return {occupied:false, until:next.s, minsUntil:toMins(next.s)-cur};
  return {occupied:false, free:true};
}

// ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ
function updateClock() {
  const d = new Date();
  document.getElementById("clock-time").textContent =
    d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"});
  document.getElementById("clock-date").textContent =
    d.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});
}

// ‚îÄ‚îÄ PINS ‚îÄ‚îÄ
function loadPins() {
  try { state.pinned = JSON.parse(localStorage.getItem("tsc_pins")||"[]"); } catch {}
  try {
    const saved = JSON.parse(localStorage.getItem("tsc_bldg_order")||"null");
    if (saved && Array.isArray(saved) && saved.length === ALL_BLDGS.length) state.bldgOrder = saved;
  } catch {}
}
function saveBldgOrder() {
  try { localStorage.setItem("tsc_bldg_order", JSON.stringify(state.bldgOrder)); } catch {}
}
function savePins() {
  try { localStorage.setItem("tsc_pins", JSON.stringify(state.pinned)); } catch {}
}
function togglePin(key, e) {
  if (e) e.stopPropagation();
  const i = state.pinned.indexOf(key);
  i>=0 ? state.pinned.splice(i,1) : state.pinned.push(key);
  savePins();
  renderRooms();
}

// ‚îÄ‚îÄ BUILD BUILDING BUTTONS ‚îÄ‚îÄ
function buildBuildingButtons() {
  const row = document.getElementById("building-row");
  row.innerHTML = "";
  const primaryCount = 7;
  const list = state.showMore ? state.bldgOrder : state.bldgOrder.slice(0, primaryCount);
  list.forEach(code => {
    if (!BLDG_NAMES[code]) return;
    const btn = document.createElement("button");
    btn.className = "bldg-btn" + (state.selBuilding === code ? " active" : "");
    btn.textContent = BLDG_NAMES[code];
    btn.onclick = () => selectBuilding(code);
    row.appendChild(btn);
  });
  const sm = document.getElementById("show-more-btn");
  sm.textContent = state.showMore ? "Show Less" : `Show More (${state.bldgOrder.length - primaryCount})`;
}

function selectBuilding(code) {
  state.selBuilding = code;
  buildBuildingButtons();
  renderRooms();
}

function toggleShowMore() {
  state.showMore = !state.showMore;
  buildBuildingButtons();
}

// ‚îÄ‚îÄ RENDER ROOMS ‚îÄ‚îÄ
function renderRooms() {
  const grid = document.getElementById("rooms-grid");
  const empty = document.getElementById("empty-state");
  const search = document.getElementById("search-input").value.toLowerCase();

  let rooms = [];
  const bldg = state.selBuilding;
  const bdata = SCHEDULE[bldg];
  if (bdata) {
    // Numeric sort for room numbers
    Object.keys(bdata).sort((a, b) => {
      const na = parseInt(a.replace(/\D/g,"")) || 0;
      const nb = parseInt(b.replace(/\D/g,"")) || 0;
      return na !== nb ? na - nb : a.localeCompare(b);
    }).forEach(room => {
      const status = getStatus(bldg, room, state.day);
      const daySlots = bdata[room].filter(s=>s.day===state.day);
      const key = `${bldg}:${room}`;
      const label = `${BLDG_NAMES[bldg]} ${room}`;
      rooms.push({bldg,room,key,label,status,classCount:daySlots.length,isPinned:state.pinned.includes(key)});
    });
  }

  // filter
  if (search) rooms = rooms.filter(r=>r.label.toLowerCase().includes(search));
  if (state.filter==="available") rooms = rooms.filter(r=>!r.status.occupied);
  else if (state.filter==="free30") rooms = rooms.filter(r=>!r.status.occupied&&(r.status.free||r.status.minsUntil>=30));
  else if (state.filter==="free60") rooms = rooms.filter(r=>!r.status.occupied&&(r.status.free||r.status.minsUntil>=60));

  // Sort: pinned first (preserve numeric order within groups)
  rooms.sort((a,b) => {
    if (a.isPinned !== b.isPinned) return a.isPinned ? -1 : 1;
    return 0; // preserve numeric insertion order
  });

  grid.innerHTML = "";
  if (rooms.length===0) { empty.style.display="block"; return; }
  empty.style.display="none";

  rooms.forEach(r => {
    const card = document.createElement("div");
    card.className = "room-card" + (r.isPinned?" pinned":"");
    card.onclick = () => showDetail(r.bldg, r.room);

    let statusHTML = "";
    if (r.status.occupied) {
      statusHTML = `<div class="room-status-occ">In use until ${fmt12(r.status.until)}</div>
                    <div class="room-course">Current: ${r.status.course}</div>`;
    } else if (r.status.free) {
      statusHTML = `<div class="room-status-free">Free rest of day</div>`;
    } else {
      statusHTML = `<div class="room-status-free">Free until ${fmt12(r.status.until)}</div>`;
    }

    card.innerHTML = `
      <button class="pin-btn${r.isPinned?" pinned":""}" onclick="togglePin('${r.key}',event)" title="${r.isPinned?"Unpin":"Pin"}">
        ${r.isPinned?"‚òÖ":"‚òÜ"}
      </button>
      <div class="room-name">${r.label}</div>
      ${statusHTML}
      <div class="room-count">${r.classCount} ${r.classCount===1?"class":"classes"} today</div>
    `;
    grid.appendChild(card);
  });
}

// ‚îÄ‚îÄ DETAIL VIEW ‚îÄ‚îÄ
function showDetail(bldg, room) {
  state.detailRoom = {bldg, room};
  const key = `${bldg}:${room}`;
  const status = getStatus(bldg, room, state.day);
  const slots = (SCHEDULE[bldg]?.[room]||[]).filter(s=>s.day===state.day);
  const isPinned = state.pinned.includes(key);
  const cur = toMins(nowStr());

  document.getElementById("detail-room-name").textContent = `${BLDG_NAMES[bldg]} ${room}`;
  document.getElementById("detail-pin-btn").textContent = isPinned ? "‚òÖ" : "‚òÜ";
  document.getElementById("detail-schedule-heading").textContent = `${state.day.toUpperCase()} SCHEDULE`;

  let boxHTML = "";
  if (status.occupied) {
    boxHTML = `<div class="status-box occ">
      <span class="status-dot occ"></span>
      <span class="status-label occ">In use until ${fmt12(status.until)}</span>
      <div class="status-sub">${status.course}</div>
      ${status.instr ? `<div class="status-sub2">${status.instr}</div>` : ""}
    </div>`;
  } else if (status.free) {
    boxHTML = `<div class="status-box free">
      <span class="status-dot free"></span>
      <span class="status-label free">Free rest of day</span>
    </div>`;
  } else {
    boxHTML = `<div class="status-box free">
      <span class="status-dot free"></span>
      <span class="status-label free">Free until ${fmt12(status.until)}</span>
      <div class="status-sub2">${status.minsUntil} min remaining</div>
    </div>`;
  }
  document.getElementById("detail-status-box").innerHTML = boxHTML;

  const slotsEl = document.getElementById("detail-slots");
  if (slots.length===0) {
    slotsEl.innerHTML = `<div style="text-align:center;padding:40px 0;color:#22c55e;font-weight:600;">
      <div style="font-size:40px;margin-bottom:8px;">‚úÖ</div>No classes today
    </div>`;
  } else {
    slotsEl.innerHTML = slots.map(s => {
      const sm = toMins(s.s), em = toMins(s.e);
      const isActive = cur>=sm&&cur<em, isPast = cur>=em;
      return `<div class="slot${isActive?" active":""}${isPast?" past":""}">
        <div class="slot-time">${fmt12(s.s)} ‚Äì ${fmt12(s.e)}${isActive?'<span class="now-badge">NOW</span>':""}</div>
        <div class="slot-course">${s.course}</div>
        ${s.instr ? `<div class="slot-instructor">${s.instr}</div>` : ""}
      </div>`;
    }).join("");
  }

  document.getElementById("main-view").classList.add("hidden");
  document.getElementById("settings-view").classList.remove("visible");
  document.getElementById("settings-view").classList.add("hidden");
  document.getElementById("detail-view").classList.remove("hidden");
  document.getElementById("detail-view").classList.add("visible");
  window.scrollTo(0,0);
}

function hideDetail() {
  state.detailRoom = null;
  document.getElementById("detail-view").classList.remove("visible");
  document.getElementById("detail-view").classList.add("hidden");
  document.getElementById("main-view").classList.remove("hidden");
}

function toggleDetailPin() {
  if (!state.detailRoom) return;
  const key = `${state.detailRoom.bldg}:${state.detailRoom.room}`;
  const i = state.pinned.indexOf(key);
  i>=0 ? state.pinned.splice(i,1) : state.pinned.push(key);
  savePins();
  document.getElementById("detail-pin-btn").textContent = state.pinned.includes(key) ? "‚òÖ" : "‚òÜ";
  renderRooms();
}

// ‚îÄ‚îÄ THEME ‚îÄ‚îÄ
function setTheme(name) {
  document.documentElement.setAttribute('data-theme', name);
  state.theme = name;
  try { localStorage.setItem('tsc_theme', name); } catch {}
  document.querySelectorAll('.theme-swatch').forEach(s => {
    s.classList.toggle('active', s.dataset.themeName === name);
  });
}
function loadTheme() {
  try { setTheme(localStorage.getItem('tsc_theme') || 'cocky'); } catch { setTheme('cocky'); }
}

// ‚îÄ‚îÄ BUILDING ORDER ‚îÄ‚îÄ
let dragSrc = null;

function buildOrderList() {
  const list = document.getElementById("bldg-order-list");
  list.innerHTML = "";
  state.bldgOrder.forEach((code, i) => {
    if (!BLDG_NAMES[code]) return;
    const li = document.createElement("li");
    li.className = "bldg-order-item";
    li.draggable = true;
    li.dataset.code = code;
    li.innerHTML = `
      <span class="drag-handle">‚†ø</span>
      <div style="flex:1">
        <span class="bldg-order-name">${BLDG_NAMES[code]}</span>
        <span class="bldg-order-code"> ¬∑ ${code}</span>
      </div>
      <div class="bldg-move-btns">
        <button class="bldg-move-btn" onclick="moveBldg('${code}',-1)" ${i===0?"disabled":""}>‚ñ≤</button>
        <button class="bldg-move-btn" onclick="moveBldg('${code}',1)" ${i===state.bldgOrder.length-1?"disabled":""}>‚ñº</button>
      </div>
    `;
    // drag events
    li.addEventListener("dragstart", e => {
      dragSrc = code;
      setTimeout(() => li.classList.add("dragging"), 0);
      e.dataTransfer.effectAllowed = "move";
    });
    li.addEventListener("dragend", () => li.classList.remove("dragging"));
    li.addEventListener("dragover", e => { e.preventDefault(); li.classList.add("drag-over"); });
    li.addEventListener("dragleave", () => li.classList.remove("drag-over"));
    li.addEventListener("drop", e => {
      e.preventDefault();
      li.classList.remove("drag-over");
      if (!dragSrc || dragSrc === code) return;
      const from = state.bldgOrder.indexOf(dragSrc);
      const to = state.bldgOrder.indexOf(code);
      state.bldgOrder.splice(from, 1);
      state.bldgOrder.splice(to, 0, dragSrc);
      saveBldgOrder();
      buildOrderList();
      buildBuildingButtons();
    });
    list.appendChild(li);
  });
}

function moveBldg(code, dir) {
  const i = state.bldgOrder.indexOf(code);
  const j = i + dir;
  if (j < 0 || j >= state.bldgOrder.length) return;
  [state.bldgOrder[i], state.bldgOrder[j]] = [state.bldgOrder[j], state.bldgOrder[i]];
  saveBldgOrder();
  buildOrderList();
  buildBuildingButtons();
}

function resetBldgOrder() {
  state.bldgOrder = [...ALL_BLDGS];
  saveBldgOrder();
  buildOrderList();
  buildBuildingButtons();
}

// ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ
function showSettings() {
  const total = Object.values(SCHEDULE).reduce((a,b)=>a+Object.keys(b).length,0);
  document.getElementById("stats-line").textContent =
    `Buildings tracked: ${ALL_BLDGS.length} ¬∑ Total rooms: ${total}`;

  const pinCount = state.pinned.length;
  document.getElementById("pin-count").textContent = pinCount;
  const listEl = document.getElementById("pinned-list");
  const clearBtn = document.getElementById("clear-pins-btn");

  if (pinCount===0) {
    listEl.innerHTML = `<p style="color:var(--text-dim);font-size:13px;">No rooms pinned. Tap ‚òÜ on any room to pin it.</p>`;
    clearBtn.style.display = "none";
  } else {
    listEl.innerHTML = state.pinned.map(k => {
      const [b,r] = k.split(":");
      return `<span class="pin-tag">‚òÖ ${BLDG_NAMES[b]||b} ${r}</span>`;
    }).join("") + "<div style='margin-top:4px'></div>";
    clearBtn.style.display = "block";
  }

  buildOrderList();
  document.querySelectorAll('.theme-swatch').forEach(s => {
    s.classList.toggle('active', s.dataset.themeName === state.theme);
  });

  document.getElementById("main-view").classList.add("hidden");
  document.getElementById("detail-view").classList.remove("visible");
  document.getElementById("detail-view").classList.add("hidden");
  document.getElementById("settings-view").classList.remove("hidden");
  document.getElementById("settings-view").classList.add("visible");
  window.scrollTo(0,0);
}

function hideSettings() {
  document.getElementById("settings-view").classList.remove("visible");
  document.getElementById("settings-view").classList.add("hidden");
  document.getElementById("main-view").classList.remove("hidden");
}

function clearPins() {
  state.pinned = [];
  savePins();
  showSettings();
  renderRooms();
}

// ‚îÄ‚îÄ DAY / FILTER BUTTONS ‚îÄ‚îÄ
document.querySelectorAll(".day-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    state.day = btn.dataset.day;
    document.querySelectorAll(".day-btn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    renderRooms();
  });
});

document.querySelectorAll(".avail-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    state.filter = btn.dataset.filter;
    document.querySelectorAll(".avail-btn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    renderRooms();
  });
});

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
loadPins();
loadTheme();
// ensure bldgOrder contains any new buildings not in saved order
ALL_BLDGS.forEach(c => { if (!state.bldgOrder.includes(c)) state.bldgOrder.push(c); });
updateClock();
setInterval(updateClock, 1000);

// Set active day button
document.querySelectorAll(".day-btn").forEach(btn => {
  if (btn.dataset.day === state.day) btn.classList.add("active");
});

buildBuildingButtons();
renderRooms();
</script>
</body>
</html>
